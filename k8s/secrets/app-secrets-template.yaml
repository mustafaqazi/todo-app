# Kubernetes Secret Template: app-secrets
#
# ⚠️  IMPORTANT: This is a TEMPLATE ONLY - NEVER commit actual secret values!
#
# Usage:
# 1. Copy this template and fill in actual values
# 2. Create secret with: kubectl create secret generic app-secrets --from-literal=...
# 3. Or: kubectl apply -f app-secrets.yaml (after replacing placeholders)
#
# The secrets defined here are referenced by both frontend and backend deployments
# via: envFrom: - secretRef: name: app-secrets
#
# ============================================================================

apiVersion: v1
kind: Secret
metadata:
  name: app-secrets
  namespace: default
  labels:
    app.kubernetes.io/name: todo
    app.kubernetes.io/component: secrets

# Secret type: Opaque (generic key-value pairs)
type: Opaque

# Data keys (base64-encoded values)
# To encode a value: echo -n "value" | base64
# To decode: echo "encodedvalue" | base64 -d
data:
  # ========================================================================
  # DATABASE_URL: PostgreSQL connection string
  # ========================================================================
  # Format: postgresql://user:password@host:port/database?sslmode=require
  #
  # Example (do NOT use these values in production):
  # DATABASE_URL=postgresql://postgres:password@neon-host:5432/neondb?sslmode=require
  #
  # To encode (Linux/Mac):
  #   echo -n "postgresql://user:password@host/db?sslmode=require" | base64
  #
  # Windows PowerShell:
  #   [Convert]::ToBase64String([System.Text.Encoding]::UTF8.GetBytes("postgresql://...")) | Set-Clipboard
  #
  DATABASE_URL: "REPLACE_WITH_BASE64_ENCODED_DATABASE_URL"

  # ========================================================================
  # BETTER_AUTH_SECRET: JWT token signing secret
  # ========================================================================
  # Shared secret used by frontend (token generation) and backend (token validation)
  # Must be identical on both sides
  #
  # Generate: openssl rand -base64 32
  #
  # To encode:
  #   echo -n "your-secret-value" | base64
  #
  BETTER_AUTH_SECRET: "REPLACE_WITH_BASE64_ENCODED_BETTER_AUTH_SECRET"

  # ========================================================================
  # COHERE_API_KEY: Cohere API key for AI chatbot
  # ========================================================================
  # Obtained from: https://dashboard.cohere.com/api-keys
  # Backend-only; never exposed to frontend
  #
  # To encode:
  #   echo -n "cohere-api-key-value" | base64
  #
  COHERE_API_KEY: "REPLACE_WITH_BASE64_ENCODED_COHERE_API_KEY"

---

# ============================================================================
# HOW TO CREATE THIS SECRET
# ============================================================================
#
# Option 1: Using kubectl command (recommended)
# ============================================================================
# kubectl create secret generic app-secrets \
#   --from-literal=DATABASE_URL='postgresql://user:password@host:port/database?sslmode=require' \
#   --from-literal=BETTER_AUTH_SECRET='your-secure-jwt-secret-here' \
#   --from-literal=COHERE_API_KEY='your-cohere-api-key-here'
#
# Option 2: Using kubectl apply with YAML file
# ============================================================================
# 1. Fill in actual base64-encoded values above (replace REPLACE_WITH_... lines)
# 2. Run: kubectl apply -f app-secrets.yaml
#
# Option 3: Using Helm secrets plugin (production)
# ============================================================================
# helm repo add secrets https://jkroepke.github.io/helm-secrets/
# helm plugin install https://github.com/jkroepke/helm-secrets
# helm install --values secrets.yaml chart/
#
# ============================================================================
# VERIFICATION
# ============================================================================
#
# List secrets:
#   kubectl get secrets
#
# View secret (base64):
#   kubectl get secret app-secrets -o yaml
#
# Decode a specific value:
#   kubectl get secret app-secrets -o jsonpath='{.data.DATABASE_URL}' | base64 -d
#
# Verify secret mounted in pod:
#   kubectl exec <pod-name> -- env | grep DATABASE_URL
#
# ============================================================================
# SECURITY NOTES
# ============================================================================
#
# - Never commit this file with actual secrets to git
# - Keep this template in version control (with REPLACE_WITH_... placeholders)
# - Create the actual secret out-of-band before helm install
# - Kubernetes Secrets are base64-encoded (NOT encrypted by default)
# - Enable encryption at rest in your Kubernetes cluster for production
# - Use separate secrets for dev/staging/production environments
# - Rotate secrets regularly
# - Use RBAC to restrict access to secrets
# - Never share secrets via email or chat
#
# ============================================================================
